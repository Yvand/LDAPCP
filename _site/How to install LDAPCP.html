<!DOCTYPE html>
<html lang="en-us">
  
  <head>
  <meta charset="UTF-8">
  <title>LDAPCP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">LDAPCP</h1>
  <h2 class="project-tagline">Most popular, free and open source claims provider for SharePoint 2013 and 2016</h2>
  <a href="#" class="btn">View on GitHub</a>
  <a href="#" class="btn">Download LDAPCP.wsp</a>
</section>


    <section class="main-content" style="float: left;" >
      <div style="display: block;">
        <div style="float: left; width: 750px;">
            <h1 id="how-to-install-ldapcp">How to install LDAPCP</h1>
<ul>
  <li>Download <a href="https://github.com/Yvand/LDAPCP/releases">latest release of LDAPCP.wsp</a>.</li>
  <li>Install and deploy the solution (that will automatically activate the “LDAPCP” farm-scoped feature):
    <div class="language-powershell highlighter-rouge"><pre class="highlight"><code>Add-SPSolution -LiteralPath <span class="s2">"PATH TO WSP FILE"</span>
Install-SPSolution -Identity <span class="s2">"LDAPCP.wsp"</span> -GACDeployment
</code></pre>
    </div>
  </li>
  <li>At this point claim provider is inactive and it must be associated to an SPTrustedIdentityTokenIssuer to work:
    <div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="nv">$trust</span> <span class="o">=</span> Get-SPTrustedIdentityTokenIssuer <span class="s2">"SPTRUST NAME"</span>
<span class="nv">$trust</span>.ClaimProviderName <span class="o">=</span> <span class="s2">"LDAPCP"</span>
<span class="nv">$trust</span>.Update<span class="o">()</span>
</code></pre>
    </div>
  </li>
</ul>

<h2 id="important---limitations">Important - Limitations</h2>
<p>Due to limitations of SharePoint API, do not associate LDAPCP with more than 1 SPTrustedIdentityTokenIssuer. Developers can bypass this limitation by inheriting LDAPCP to create new claims providers (with different names). Read “Developers section” below for further information.</p>

<p>You must manually deploy ldapcp.dll on SharePoint servers that do not have SharePoint service “Microsoft SharePoint Foundation Web Application” started. You can use this PowerShell script:</p>
<div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>System.Reflection.Assembly]::Load<span class="o">(</span><span class="s2">"System.EnterpriseServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="o">)</span>
<span class="nv">$publish</span> <span class="o">=</span> <span class="nb">New-Object </span>System.EnterpriseServices.Internal.Publish
<span class="nv">$publish</span>.GacInstall<span class="o">(</span><span class="s2">"C:</span><span class="se">\D</span><span class="s2">ata</span><span class="se">\D</span><span class="s2">ev</span><span class="se">\l</span><span class="s2">dapcp.dll"</span><span class="o">)</span>
</code></pre>
</div>

        </div>
        <div style="float: left; width: 200px;">
            <ul>

    <li><a href="How to install LDAPCP.html" alt="How to install LDAPCP">How to install LDAPCP</a></li>

    <li><a href="configuration.html" alt="Configuration">Configuration</a></li>

    <li><a href="deployment.html" alt="Deployment">Deployment</a></li>

</ul>
        </div>
      </div>
    </section>
    <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">LDAPCP</a> is maintained by <a href="https://www.linkedin.com/in/yvand/">Yvan Duhamel</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>

  </body>
</html>
